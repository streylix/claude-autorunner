#!/bin/bash
# Test the bot is working

echo "🧪 Testing Claude Bot..."
echo ""

# Check if bot is running
if python3 claudebot.py --status > /dev/null 2>&1; then
    echo "✅ Bot is online"
else
    echo "❌ Bot is offline"
    echo "Start it with: ./start_with_backend.sh"
    exit 1
fi

# Send a test command
TEST_MSG="echo 'Bot test at $(date +%H:%M:%S)'"
echo "📤 Sending test command: !addmsg \"$TEST_MSG\" 1"
echo "!addmsg \"$TEST_MSG\" 1" > /tmp/claude-bot-commands

# Wait a moment
sleep 1

# Check if trigger file was created
if [ -f /tmp/claude-code-addmsg-trigger ]; then
    echo "✅ Bot processed command (trigger file created)"
    echo "📄 Trigger content: $(cat /tmp/claude-code-addmsg-trigger)"
else
    echo "⚠️  No trigger file found (bot may still be processing)"
fi

echo ""
echo "To manually test:"
echo "  1. ./send-to-bot '!addmsg \"ls -la\" 1'"
echo "  2. echo '!addmsg \"pwd\" 2' > /tmp/claude-bot-commands"
echo ""
echo "Check status: ./bot-status"